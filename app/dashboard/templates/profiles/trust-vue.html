{% load i18n static humanize %}

{% if not profile.is_org and is_my_profile %}

<!-- Passport Modal -->
<div class="modal fade" id="passportModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLabel">Generate your Proof of Personhood Passport</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <img class="float-left p-2" src="/static/v2/images/passport-cover.png" style="max-width:200px;">
        <div class="subbody">
          <strong>What:</strong> PoPP aggregates the top personhood-identity providers in the web3 space into one transportable identity that proves your personhood.
          <hr>
          <strong>How:</strong> You can generate your Proof of Personhood Passport via the following methods.
        </div>
      </div>
      <div class="modal-footer">
        <button type="button" id="gen_passport" class="btn btn-primary">NFT</button>
        <button type="button" class="btn btn-secondary disabled">3Box (coming soon)</button>
        <button type="button" class="btn btn-secondary disabled">SpruceID (coming soon)</button>
      </div>
    </div>
  </div>
</div>

  <div id="gc-trust-manager-app" v-cloak>
    <active-trust-manager inline-template>
      <div>

        <why-this-matters-modal
          :show-modal="visibleModal === 'why-this-matters-modal'"
          @modal-dismissed="hideModal()">
        </why-this-matters-modal>

        <brightid-verify-modal
          :service="serviceDict.brightid"
          :show-validation="visibleModal === 'brightid-modal'"
          :brightid-uuid="serviceDict.brightid.uuid"
          :validation-step="(serviceDict.brightid._status === 'not_connected' || serviceDict.brightid._status === 'unknown' ?
            'connect-brightid' : (serviceDict.brightid._status !== 'verified' ?
              'verify-brightid' : 'disconnect'
            )
          )"
          @modal-dismissed="hideModal()">
        </brightid-verify-modal>

        <idena-verify-modal
          :service="serviceDict.idena"
          :show-validation="visibleModal === 'idena-modal'"
          :validation-step="(serviceDict.idena.is_verified ?
            'verified' : (serviceDict.idena.is_connected ?
              'connected' : 'connect'
            )
          )"
          @modal-dismissed="hideModal()">
        </idena-verify-modal>

        <sms-verify-modal
          :service="serviceDict.sms"
          :show-validation="visibleModal === 'sms-modal'"
          :validation-step="(!serviceDict.sms.is_verified ? 'intro' : 'disconnect')"
          @modal-dismissed="hideModal()">
        </sms-verify-modal>

        <twitter-verify-modal
          :service="serviceDict.twitter"
          :show-validation="visibleModal === 'twitter-modal'"
          :validation-step="(!serviceDict.twitter.is_verified ? 'send-tweet' : 'disconnect')"
          @modal-dismissed="hideModal()">
        </twitter-verify-modal>

        <poap-verify-modal
          :service="serviceDict.poap"
          :show-validation="visibleModal === 'poap-modal'"
          :validation-step="(!serviceDict.poap.is_verified ? 'validate-address' : 'disconnect')"
          :service="serviceDict.poap"
          @modal-dismissed="hideModal()">
        </poap-verify-modal>

        <ens-verify-modal
          :service="serviceDict.ens"
          :show-validation="visibleModal === 'ens-modal'"
          :validation-step="(!serviceDict.ens.is_verified ? 0 : 'disconnect')"
          @modal-dismissed="hideModal()">
        </ens-verify-modal>

        <duniter-verify-modal
          :show-validation="visibleModal === 'duniter-modal'"
          @modal-dismissed="hideModal()">
        </duniter-verify-modal>

        <poh-verify-modal
          :service="serviceDict.poh"
          :show-validation="visibleModal === 'poh-modal'"
          :validation-step="(!serviceDict.poh.is_verified ? 'validate-address' : 'disconnect')"
          @modal-dismissed="hideModal()">
        </poh-verify-modal>

        <google-verify-modal
          :service="serviceDict.google"
          :show-validation="visibleModal === 'google-modal'"
          :validation-step="(!serviceDict.google.is_verified ? 'connect' : 'disconnect')"
          @modal-dismissed="hideModal()">
        </google-verify-modal>

        <facebook-verify-modal
          :service="serviceDict.facebook"
          :show-validation="visibleModal === 'facebook-modal'"
          :validation-step="(!serviceDict.facebook.is_verified ? 'connect' : 'disconnect')"
          @modal-dismissed="hideModal()">
        </facebook-verify-modal>

        {% if is_staff %}
        <div class="row">
          <div class="col-6 d-none d-lg-block col-xl-7"></div>
          <div class="text-left position-relative col-12 col-lg-6 col-xl-5" style="padding: 5px; min-height: 115px;">
            <img class="p-2 position-absolute left-0" src="/static/v2/images/passport-cover.png" style="max-width:100px; margin-top: -10px;">
            <div style="padding-left: 100px;">
              <strong class="pb-2 d-block">STAFF ONLY</strong> Take your TrustBonus with you across the web with <a href="https://proofofpersonhood.com/">your Proof of Personhood Passport</a>.
            </div>
            <div class="text-right pt-2">
              <a data-toggle="modal" data-target="#passportModal" href="#" role="button" class="bottom-0 btn btn-primary">Try It!</a>
            </div>
          </div>
        </div>
        <hr>
        {% endif %}

        <div class="bg-violet-300 text-white spacer-p-4 spacer-mt-5">
          <div class="row">
            <div class="col-12 col-lg-9">
              <h2>Gitcoin Now Matches Up to 150%</h2>
              <span class="font-smaller-1 line-height-2">On Gitcoin verified users have 100% (or more) of their donation amount count towards the match fund algorithm. Unverified users begin with 50%. To ensure sybil resistance and protect Quadratic Funding, please verify your account below.</span>
              <div class="row spacer-mt-3 font-smaller-1 line-height-2">
                <div class="col-12 col-lg-6">
                  <a><i class="far fa-calendar-alt spacer-pr-2"></i> Verify during [[round_start_date]] - [[round_end_date]]</a>
                </div>
                <div class="col-12 col-lg-6">
                  <span @click="showModal('why-this-matters-modal')" class="cursor-pointer hover-underline"><i class="fas fa-play-circle spacer-pr-2"></i> Why this matters</span>
                </div>
              </div>
            </div>
            <div class="col-12 col-lg-3 text-center text-lg-right">
              <svg class="spacer-mr-4 spacer-mt-3 spacer-mt-lg-0" width="158" height="158" viewBox="0 0 158 158" fill="none" xmlns="http://www.w3.org/2000/svg">
                <ellipse cx="79.0004" cy="78.9438" rx="79.0004" ry="78.9438" fill="#5932C4"/>
                <path fill-rule="evenodd" clip-rule="evenodd" d="M2.58455 88.7034H0V86.3043H2.58455V88.7034ZM12.9227 88.7034H7.75364V86.3043H12.9227V88.7034ZM23.2609 88.7034H18.0918V86.3043H23.2609V88.7034ZM33.5991 88.7034H28.43V86.3043H33.5991V88.7034ZM43.9373 88.7034H38.7682V86.3043H43.9373V88.7034ZM54.2755 88.7034H49.1064V86.3043H54.2755V88.7034ZM64.6137 88.7034H59.4446V86.3043H64.6137V88.7034ZM74.9519 88.7034H69.7828V86.3043H74.9519V88.7034ZM85.2901 88.7034H80.121V86.3043H85.2901V88.7034ZM95.6283 88.7034H90.4592V86.3043H95.6283V88.7034ZM105.967 88.7034H100.797V86.3043H105.967V88.7034ZM116.305 88.7034H111.136V86.3043H116.305V88.7034ZM126.643 88.7034H121.474V86.3043H126.643V88.7034ZM136.981 88.7034H131.812V86.3043H136.981V88.7034ZM147.319 88.7034H142.15V86.3043H147.319V88.7034ZM157.657 88.7034H152.488V86.3043H157.657V88.7034Z" fill="#02E2AC"/>
                <path d="M113.736 124.788L125.268 130.04L135.304 135.055C123.261 149.095 105.762 154.718 94.1578 157.117C72.0791 160.126 54.3184 155.112 40.9682 147.089L42.1303 145.083C46.2428 137.104 51.2163 133.312 51.6991 133.057C51.4648 126.658 50.3887 113.116 49.3126 100.212L46.2655 100.429H45.6126C41.9126 100.429 38.6479 97.6017 38.4303 93.9044L37.342 80.42C37.342 78.4626 37.7773 76.7226 39.0832 75.2002C39.9538 74.1128 41.042 73.4603 42.1303 73.0253C42.5655 73.2428 43.2185 73.0253 43.4361 72.5903H43.8714C44.0891 72.8078 44.5244 72.8078 44.9597 72.8078C45.395 73.0253 46.0479 73.0253 46.7008 72.8078C47.5714 72.3728 47.7891 71.5029 47.3538 70.8504C47.5714 62.8033 49.5302 56.0611 54.3184 49.5364C56.4949 46.709 58.889 43.6641 61.5008 41.2717C62.589 40.1843 63.8949 39.3143 65.2008 38.6618C66.9419 38.0094 68.9007 37.3569 70.8595 36.7044C72.6007 36.2695 74.3419 36.052 76.083 35.8345C76.3007 35.617 76.3007 35.617 76.5184 35.617C80.8713 35.8345 84.7889 35.182 89.1418 36.7044C93.2771 38.2269 96.9771 41.0542 100.024 44.0991C102.418 46.4915 104.377 49.5363 106.336 52.5812C106.118 53.0162 106.118 53.2337 106.336 53.6687C107.206 55.4086 108.295 57.366 109.165 59.3234C109.601 60.8459 109.818 62.5858 110.254 64.3257V64.5432C110.471 64.7606 110.471 64.7607 110.471 64.9781V64.9782C110.471 65.1957 110.906 65.4131 111.124 65.6306V67.1531V69.5455C111.124 69.9804 111.559 70.6329 111.995 70.6329C113.301 70.8504 114.824 70.4154 116.13 70.1979C117.436 70.4154 118.742 71.0679 119.83 71.9378C121.136 73.2428 122.006 74.9827 122.006 76.9401L122.442 90.4245C122.442 94.3394 119.395 97.6017 115.477 97.8192H112.865L113.736 124.788Z" fill="white"/>
                <path d="M65.4041 73.2466C65.4041 73.2466 95.4511 71.9407 100.892 73.2456C106.333 74.5505 103.939 74.9862 103.939 74.9862C103.939 74.9862 105.898 96.9527 105.463 97.3877C105.028 97.6052 104.592 99.5625 100.892 100.867C97.1923 102.172 61.7159 102.172 61.7159 102.172C61.7159 102.172 56.4924 101.085 56.4924 95.2128C56.4924 89.3405 56.4924 77.596 56.4924 77.596L59.7571 73.2462L65.4041 73.2466Z" fill="#F2EFFF"/>
                <path d="M52.1389 133.272C51.6457 133.436 46.0615 135.958 41.4827 146.086" stroke="#8C65F7" stroke-miterlimit="10"/>
                <path d="M135.304 135.055L113.733 125.445" stroke="#8C65F7" stroke-miterlimit="10"/>
                <path d="M114.606 125.443L113.735 98.4743L112.865 70.6355V67.5906C112.865 67.1556 108.076 31.9222 77.8236 34.9671C47.5708 37.7945 47.1355 69.1131 47.1355 69.548C47.1355 69.548 47.1355 70.6355 47.3531 72.5929C47.7884 77.8127 48.8767 88.6872 49.7472 100.214C50.8355 113.264 51.9237 126.965 52.1414 133.273V135.665C52.1414 136.97 52.359 138.275 52.5767 139.145C52.7943 139.797 53.0119 140.45 53.4472 141.102C53.8825 141.755 54.3178 142.407 54.7531 142.842C58.0178 145.887 62.5884 145.887 62.806 145.887H98.0647V145.017C98.0647 144.8 99.3706 131.098 113.3 126.313L114.606 125.443Z" stroke="#8C65F7" stroke-miterlimit="10"/>
                <path d="M96.9743 119.352C97.4096 121.526 97.192 123.266 96.1037 124.571C94.7978 126.311 92.6214 126.529 92.6214 126.529H76.2979C71.0744 126.529 68.8979 123.266 68.4626 121.744" stroke="#8C65F7" stroke-miterlimit="10"/>
                <path d="M105.028 78.0286C105.028 76.9412 104.592 75.8537 103.939 74.9837C103.069 73.8963 101.98 73.2438 100.675 72.8088C100.239 72.8088 100.022 72.8088 99.5864 72.8088H99.3687L61.9336 73.8963C61.7159 73.8963 61.7159 73.8963 61.4983 73.8963C60.1924 73.8963 59.1042 74.5487 58.2336 75.4187C58.2336 75.4187 58.2336 75.4187 58.016 75.6362C56.9277 76.7237 56.4924 78.0286 56.4924 79.551L57.1454 96.9503C57.1454 98.4727 57.7983 99.7776 58.8865 100.648C59.9748 101.518 61.2807 102.17 62.5865 102.17H62.8042L100.239 100.865C103.286 100.865 105.68 98.2552 105.463 95.2103L105.028 78.0286Z" stroke="#8C65F7" stroke-miterlimit="10"/>
                <path d="M122.878 77.595C122.878 75.6376 122.225 73.8976 121.137 72.5927C120.266 71.7227 119.178 71.0703 118.09 70.8528C117.654 70.8528 117.437 70.6353 116.784 70.8528H116.349H114.607H113.302L114.172 98.474H115.26H117.437C120.702 98.2566 123.313 94.9942 123.313 91.0794L122.878 77.595Z" stroke="#8C65F7" stroke-miterlimit="10"/>
                <path d="M47.3511 72.376H46.4805L44.0864 72.5935H43.8688C43.2158 72.5935 42.7805 72.811 42.3452 73.0285C41.257 73.4635 40.1688 74.116 39.2982 75.2034C38.2099 76.7258 37.7747 78.4658 37.7747 80.4232L38.8629 93.9076C39.0805 97.6049 42.1276 100.432 45.3923 100.432C45.6099 100.432 45.8276 100.432 46.0452 100.432L48.8746 100.215H49.9628L47.3511 72.376Z" stroke="#8C65F7" stroke-miterlimit="10"/>
                <path d="M42.7813 73.2455C42.5636 66.5033 42.5636 25.6152 75.4282 23.0053C86.7458 22.1353 96.1046 24.9627 103.069 31.7049C116.563 44.3193 116.999 67.1558 116.781 70.6357V71.0706" stroke="#8C65F7" stroke-miterlimit="10"/>
                <path d="M125.488 130.881C115.371 132.412 110.052 142.575 107.256 153.106" stroke="#8C65F7" stroke-miterlimit="10"/>
                <path d="M52.7928 139.144C50.2857 142.101 48.4024 145.68 46.9885 149.452" stroke="#8C65F7" stroke-miterlimit="10"/>
                <path d="M57.802 76.0743L60.8491 71.507C62.5902 68.8972 64.9843 67.3747 67.5961 67.3747L93.7136 66.2873C96.543 66.0698 99.3724 67.5922 101.114 70.4196L103.943 74.7694" stroke="#8C65F7" stroke-miterlimit="10"/>
                <path d="M38.6239 27.0071H29.2183V32.6402M125.84 27.0071H135.245V32.6402M125.84 124.648H135.245V119.015M38.6239 124.648H29.2183V119.015" stroke="#8C65F7"/>
                <path d="M85.498 140.072V35.7749L87.5052 34.7729L94.5302 35.7749C96.8719 36.4435 102.559 37.7808 106.573 37.7814C107.269 37.7816 112.393 34.1507 113.466 32.0699C113.26 31.899 113.215 31.7641 113.598 31.7635C117.004 31.7579 113.522 31.6847 114.602 32.7673C116.733 35.1055 115.249 36.8109 114.602 37.7806L119.62 36.7778C123.634 36.7778 129.321 36.1092 131.663 35.7749C132.465 39.7863 131.328 45.4692 130.659 47.8092C129.856 57.4366 122.296 60.512 118.616 60.8463C120.289 65.192 124.035 76.892 125.641 88.9263C127.247 100.961 116.906 111.655 112.222 116.001C112.829 123.884 96.9535 131.629 85.498 140.072Z" fill="white"/>
                <path d="M124.265 130.04C113.225 126.029 114.339 123.875 112.771 116.553" stroke="#8C65F7"/>
                <path d="M124.466 85.9002C128.106 101.084 118.74 116.343 103.545 119.981C97.6466 121.393 91.7371 120.846 86.5009 118.761" stroke="#8C65F7"/>
                <path d="M118.405 60.6259L124.59 86.4221" stroke="#8C65F7"/>
                <path d="M85.1662 35.5977C91.6579 34.5099 96.5625 35.6627 100.458 37.2109L100.49 37.2109C105.237 38.7545 108.851 36.0328 113.092 31.9299C113.15 31.8737 113.219 31.8301 113.295 31.8018C113.371 31.7734 113.451 31.761 113.532 31.7652C113.613 31.7695 113.692 31.7903 113.764 31.8264C113.836 31.8624 113.9 31.913 113.953 31.9751C115.786 34.1732 115.692 35.7349 115.051 37.0845C115.024 37.1613 115.017 37.2442 115.033 37.3244C115.049 37.4045 115.085 37.4789 115.14 37.5396C115.194 37.6003 115.264 37.645 115.341 37.669C115.419 37.693 115.501 37.6953 115.58 37.6758C119.431 36.2585 127.868 37.9421 131.087 35.6627C131.149 35.625 131.218 35.6027 131.29 35.5977C131.361 35.5927 131.433 35.6051 131.499 35.6338C131.565 35.6626 131.623 35.7069 131.669 35.7629C131.714 35.819 131.745 35.8853 131.76 35.9561C133.109 46.4683 129.317 55.6581 122.964 59.1787C118.36 61.8056 100.718 63.5795 95.3924 62.9747C92.8997 62.6903 88.0803 62.2254 85.1662 61.9004C85.0767 61.9041 84.9904 61.9346 84.9183 61.9881C84.8462 62.0417 84.7917 62.1157 84.7618 62.2007C84.7319 62.2857 84.728 62.3777 84.7505 62.465C84.7731 62.5523 84.821 62.6307 84.8883 62.6903C91.7588 67.2561 89.9621 75.1238 86.8318 79.4765" stroke="#8C65F7"/>
                <line x1="85.6003" y1="14.5423" x2="85.6003" y2="157.674" stroke="#02E2AC" stroke-width="0.5" stroke-dasharray="2.1 2.1"/>
              </svg>
            </div>
          </div>
        </div>

        <div class="row spacer-mt-6 text-grey-500 font-smaller-1">
          <div class="col-12 col-lg-8 spacer-pb-3">
            <h3>Trust Verification</h3>
           <span class="line-height-2">All users begin with 50% towards the match fund algorithm. Verify with these services to get <b>up to 150% (maximum)</b> towards the match fund algorithm.</span>
          </div>
          <div class="col-12 col-lg-4 mt-2 m-lg-auto">
            <div class="spacer-mb-2">Verification Level</div>
            <div class="progress rounded-0" style="height: 0.4rem;">
              <div class="progress-bar bg-secondary" role="progressbar" :style="{width: `${100/150 * trust_bonus}%`}" :aria-valuenow="`${100/150 * trust_bonus}%`" aria-valuemin="0" aria-valuemax="100"></div>
            </div>
            <div class="spacer-mt-2 font-weight-bold">You'll receive [[trust_bonus]]% of 150% Match</div>
          </div>
        </div>
        <div class="row font-smaller-1" v-for="i in Math.ceil(services.length / 3)">
          <div class="col-12 col-lg-4 spacer-mt-5" v-for="service in services.slice((i - 1) * 3, i * 3)">
            <div class="card rounded-0 spacer-p-3" style="height: 100%; min-height:300px;">
              <div class="row">
                <div class="col-9">
                  <span class="font-bigger-2 text-primary">[[service.name]]</span>
                </div>
                <div class="col-3 text-right">
                  <img v-if="service.icon_path" width="41" height="40" :src="[[service.icon_path]]"/>
                  <span v-else >
                    <i :class="[[service.icon_class]]" v-bind:style="service.icon_style"></i>
                  </span>
                </div>
              </div>
              <div class="row spacer-mb-3">
                <div class="col-12">
                  <span class="text-grey-300">[[service.match_percent]]% match</span>
                </div>
              </div>
              <div class="row mb-lg-4 my-auto my-lg-0">
                <div class="col">
                  <span class="text-grey-400 line-height-4 line-clamp-3">[[service.desc]]</span>
                </div>
              </div>
              <div class="row mt-auto">
                <div class="col-6 m-auto text-success" :class="(service.is_verified || service.status ? 'd-flex' : 'd-none d-lg-flex')">
                  <span v-if="service.is_verified">
                    <i class="far fa-check-circle"></i> <i>Verified</i>
                  </span>
                  <span v-if="service.status" style="color: orange;">
                    <i class="fal fa-exclamation-circle"></i> <i>[[service.status]]</i>
                  </span>
                </div>
                <div class="text-right" :class="(service.is_verified && !service.status ? 'col-6' : 'col-12 col-lg-6')">
                  <button v-if="!service.is_verified" class="btn btn-primary w-100 w-md-auto px-md-3" @click="showModal(service.ref + '-modal')">Verify</button>
                  <button v-else class="btn btn-outline-primary" @click="showModal(service.ref + '-modal')">Disconnect</button>
                </div>
              </div>
            </div>
          </div>
        </div>

        <div class="row spacer-my-6">
          <div class="col-auto">
            <i class="far fa-life-ring text-primary" style="font-size: 46px"></i>
          </div>
          <div class="col">
              <h3>Need help verifying identity?</h3>
              <span>Please contact the services directly for any questions or support in getting your identity confirmed.</span>
          </div>
        </div>
        
        <div class="accordion-group gc-accordion spacer-mb-7" style="margin-left: -27px;" id="accordion-group">
          <h5 class="accordion collapsed" id="headingOne" data-parent="#accordion-group" data-toggle="collapse" data-target="#collapseOne" aria-controls="collapseOne">
            <span class="accordion-title">
              Coming Soon
            </span>
          </h5>
          <div class="accordion-panel collapse font-subheader text-grey-400" id="collapseOne" aria-labelledby="headingOne" data-parent="#accordion-group">
            <div class="container mt-4">
              <p>
                Verifying with these services doesn't provide a matching bonus yet, but will in future Grants rounds.
              </p>
              <!-- <active-trust-row-template icon-type="image" icon-path="/static/v2/images/project_logos/duniter_brand.png"
                title="Verify with Duniter" :match-percent=0 :is-verified="'{{is_duniter_verified}}' === 'True'" button-text="Verify"
                @verify-button-pressed="showModal('duniter-modal')">
                <template v-slot:description>
                  Verify your Duniter Account
                </template>
              </active-trust-row-template> -->
              <div v-for="service in coming_soon">
                <inactive-trust-row-template :service="service" :when="'Coming Soon'"></inactive-trust-row-template>
              </div>
            </div>

            <div>
              <div class="container mt-4">
                <h5>Roadmap</h5>
                <a class="py-2 d-block" href="https://twitter.com/owocki/status/1304422182043303937" target="_blank">To view our full roadmap click here</a>
                <div v-for="service in roadmap">
                  <inactive-trust-row-template :service="service" :when="'On the Roadmap'"></inactive-trust-row-template>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

    </active-trust-manager>


  </div>

{% endif %}
